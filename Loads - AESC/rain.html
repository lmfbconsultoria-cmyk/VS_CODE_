<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASCE Rain Load Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        // This script is in shared-utils.js, but needs to run early to prevent FOUC.
        (function() {
            const isDark = localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);
            document.documentElement.classList.toggle('dark', isDark);
        })();
    </script>
    <link rel="stylesheet" href="../styles.min.css">
    <script src="../shared-utils.js" defer></script>
    <script src="rain.js" defer></script>
</head>
<body class="bg-gray-50 text-gray-800 dark:bg-gray-900 dark:text-gray-300" style="font-family: 'Inter', sans-serif;">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <header class="text-center mb-8 relative">
             <div class="flex justify-center mb-4 flex-wrap">
                <div class="relative inline-flex bg-gray-200 dark:bg-gray-700 rounded-lg p-1">
                    <a href="wind.html" class="px-4 py-2 text-sm font-medium rounded-md z-10 transition-colors toggle-inactive">Wind Load</a>
                    <a href="snow.html" class="px-4 py-2 text-sm font-medium rounded-md z-10 transition-colors toggle-inactive">Snow Load</a>
                    <a href="rain.html" class="px-4 py-2 text-sm font-medium rounded-md z-10 transition-colors toggle-active">Rain Load</a>
                    <a href="combos.html" class="px-4 py-2 text-sm font-medium rounded-md z-10 transition-colors toggle-inactive">Load Combos</a>
                </div>
            </div>
            <h1 id="main-title" class="text-3xl md:text-4xl font-bold">ASCE Rain Load Calculator</h1>
            <button id="theme-toggle" type="button" class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-2.5 absolute top-0 right-0">
                <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
                <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.707.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 5.05A1 1 0 003.636 6.464l.707.707a1 1 0 001.414-1.414l-.707-.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 100 2h1z" fill-rule="evenodd" clip-rule="evenodd"></path></svg>
            </button>
        </header>

        <main id="rain-calculator-form">
             <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    <div class="form-section">
        <h2>Rain Load Diagram</h2>
        <div class="diagram">
            <svg viewBox="0 0 400 200" class="w-full h-auto" xmlns="http://www.w3.org/2000/svg"><rect x="50" y="150" width="300" height="10" class="svg-member"/><rect x="175" y="100" width="50" height="50" fill="none" stroke="#9ca3af" stroke-dasharray="2 2"/><path d="M50 100 L350 100" stroke="#60a5fa" stroke-width="2"/><text x="200" y="90" class="svg-label">Ponded Water</text><line x1="150" y1="100" x2="150" y2="150" class="svg-dim"/><text x="135" y="125" class="svg-dim-text" transform="rotate(-90 135,125)">d_s</text><line x1="250" y1="80" x2="250" y2="100" class="svg-dim"/><text x="260" y="90" class="svg-dim-text">d_h</text></svg>
        </div>
    </div>
    <div class="form-section">
        <h2>General Parameters</h2>
        <div class="grid grid-cols-2 gap-4">
            <div>
                <label for="rain_asce_standard" class="block text-sm font-medium mb-1">ASCE Standard</label>
                <select id="rain_asce_standard">
                    <option value="ASCE 7-16" selected>ASCE 7-16</option>
                    <option value="ASCE 7-22">ASCE 7-22</option>
                </select>
            </div>
            <div>
                <label for="rain_unit_system" class="block text-sm font-medium mb-1">Unit System</label>
                <select id="rain_unit_system">
                    <option value="imperial" selected>Imperial (in, psf)</option>
                    <option value="metric">Metric (mm, kPa)</option>
                </select>
            </div>
             <div>
                <label for="rain_design_method" class="block text-sm font-medium mb-1">Design Method</label>
                <select id="rain_design_method">
                    <option value="ASD" selected>ASD</option>
                    <option value="LRFD">LRFD</option>
                </select>
            </div>
    </div>
     <div class="form-section">
        <h2>Drainage Properties</h2>
        <div class="grid grid-cols-2 gap-4">
             <div>
                <label for="rain_jurisdiction" class="block text-sm font-medium mb-1">Jurisdiction</label>
                <select id="rain_jurisdiction">
                    <option value="ASCE 7" selected>ASCE 7</option>
                    <option value="NYCBC 2022">NYCBC 2022</option>
                </select>
            </div>
            <div>
                <label for="rain_tributary_area" class="block text-sm font-medium mb-1">Tributary Area (A)</label>
                <input type="number" id="rain_tributary_area" value="1000">
            </div>
            <div>
                <label for="rain_intensity" class="block text-sm font-medium mb-1">Rainfall Intensity (i)</label>
                <input type="number" id="rain_intensity" value="4.0">
            </div>
            <div>
                <label for="rain_city_selector" class="block text-sm font-medium mb-1">Select City (for intensity)</label>
                <select id="rain_city_selector">
                    <option value="">-- Select a City --</option>
                    <option value="4.0">New York, NY</option>
                    <option value="3.5">Los Angeles, CA</option>
                    <option value="4.2">Chicago, IL</option>
                    <option value="5.5">Houston, TX</option>
                    <option value="3.8">Phoenix, AZ</option>
                    <option value="3.9">Philadelphia, PA</option>
                    <option value="4.5">Miami, FL</option>
                </select>
            </div>
        </div>
    </div>
     <div class="form-section">
        <h2>Drainage Properties</h2>
        <div class="flex items-center mb-4">
            <label for="dh_auto_calc_toggle" class="text-sm font-medium mr-3">Calculate d<sub>h</sub> automatically?</label>
            <input type="checkbox" id="dh_auto_calc_toggle" class="h-5 w-5 rounded" checked>
        </div>
        <div class="grid grid-cols-2 gap-4">
            <div>
                <label for="rain_static_head" class="block text-sm font-medium mb-1">Static Head (ds)</label>
                <input type="number" id="rain_static_head" value="2.0">
            </div>
            <div id="dh_manual_input_container" class="hidden">
                <label for="rain_hydraulic_head" class="block text-sm font-medium mb-1">Hydraulic Head (dh)</label>
                <input type="number" id="rain_hydraulic_head" value="1.0">
            </div>
        </div>
        <div id="dh_auto_calc_container" class="mt-4 space-y-4 border-t pt-4 dark:border-gray-600">
             <div class="grid grid-cols-2 gap-4">
                <div>
                    <label for="rain_drain_type" class="block text-sm font-medium mb-1">Secondary Drain Type</label>
                    <select id="rain_drain_type">
                        <option value="scupper" selected>Scupper</option>
                        <option value="drain">Roof Drain</option>
                    </select>
                </div>
                <div id="scupper_inputs">
                    <label for="rain_scupper_width" class="block text-sm font-medium mb-1">Scupper Width (L)</label>
                    <input type="number" id="rain_scupper_width" value="12">
                </div>
                <div id="drain_inputs" class="hidden">
                    <label for="rain_drain_diameter" class="block text-sm font-medium mb-1">Drain Diameter (d)</label>
                    <input type="number" id="rain_drain_diameter" value="4">
                </div>
            </div>
        </div>
        <p class="text-xs text-gray-500 dark:text-gray-400 mt-4">
            Note: The rainfall intensity (i) is used to calculate the hydraulic head (d<sub>h</sub>) based on the roof's tributary area and secondary drainage system capacity, per ASCE 7 and the International Plumbing Code.
        </p>
    </div>
    <div class="lg:col-span-3 mt-8 flex justify-center">
        <button id="load-rain-inputs-btn" class="bg-gray-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-gray-600 mr-4">Load Inputs</button>
        <button id="save-rain-inputs-btn" class="bg-green-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-700 mr-4">Save Inputs</button>
        <button id="run-rain-calculation-btn" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-all duration-300 transform hover:scale-105">Run Rain Load Calculation</button>
        <input type="file" id="rain-file-input" class="hidden" accept=".txt">
    </div>
        </main>

        <div id="feedback-message" class="text-center mt-2 text-sm h-5"></div>
        <div id="rain-results-container" class="mt-10 results-container"></div>

    </div>
</body>
</html>